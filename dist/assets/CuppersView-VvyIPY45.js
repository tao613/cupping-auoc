import{aw as Z,r as m,X as L,k as ee,y as A,A as t,P as s,H as i,ag as d,M as v,z as S,L as _,V as te}from"./vue-vendor-BT5MiFnI.js";import{_ as se}from"./no-results-DsLkuETs.js";import{_ as ae,a as ne}from"./index-Btw0mGWG.js";const oe=Z("cuppers",{state:()=>({cuppers:[],stats:{members:0,admins:0,pendingInvites:0,seatsAvailable:0},loading:!1,error:null,pagination:{page:1,limit:10,total:0}}),getters:{getCupperById:r=>n=>r.cuppers.find(l=>l.id===n)},actions:{async fetchCuppers(r={}){this.loading=!0,this.error=null;try{const n={data:[],pagination:{page:r.page||1,limit:r.limit||10,total:0}};return this.cuppers=n.data,this.pagination=n.pagination,n}catch(n){throw this.error=n.message||"Failed to fetch cuppers",n}finally{this.loading=!1}},async fetchCupperStats(){this.loading=!0,this.error=null;try{const r={members:1,admins:1,pendingInvites:0,seatsAvailable:1};return this.stats=r,r}catch(r){throw this.error=r.message||"Failed to fetch cupper stats",r}finally{this.loading=!1}},async inviteCupper(r){this.loading=!0,this.error=null;try{const n={id:Date.now(),email:r,status:"pending",createdAt:new Date().toISOString()};return this.stats.pendingInvites++,n}catch(n){throw this.error=n.message||"Failed to invite cupper",n}finally{this.loading=!1}},async updateCupperPermissions(r,n){this.loading=!0,this.error=null;try{const l=this.cuppers.findIndex(c=>c.id===r);if(l!==-1){const c={...this.cuppers[l],...n,updatedAt:new Date().toISOString()};return this.cuppers[l]=c,n.isAdmin!==void 0&&(n.isAdmin&&!this.cuppers[l].isAdmin?this.stats.admins++:!n.isAdmin&&this.cuppers[l].isAdmin&&this.stats.admins--),c}throw new Error("Cupper not found")}catch(l){throw this.error=l.message||"Failed to update cupper permissions",l}finally{this.loading=!1}}}}),ie={class:"cuppers-view"},le={class:"page-header"},re={class:"header-actions"},de={class:"stats-cards"},ue={class:"stat-card"},pe={class:"content"},ce={class:"count"},me={class:"stat-card"},ve={class:"content"},_e={class:"count"},fe={class:"stat-card"},ge={class:"content"},he={class:"count"},ye={class:"stat-card"},we={class:"content"},be={class:"count"},Ce={class:"cuppers-container"},Ve={class:"search-bar"},Ae={key:0,class:"loading-state"},Se={key:1,class:"empty-state"},Ie={key:2},Ne={class:"cuppers-table"},Ue={class:"user-info"},ke={class:"avatar"},xe={class:"name"},Fe={class:"email"},Pe={class:"pagination"},Me={__name:"CuppersView",setup(r){const n=oe(),l=ne(),c=m([]),I=m(!0),g=L({members:0,admins:0,pendingInvites:0,seatsAvailable:0}),N=m(""),w=m(1),P=m(10),M=m(0),h=m(!1),U=m(!1),u=L({name:"",email:"",role:"member"});ee(async()=>{await Promise.all([b(),C()])});const b=async()=>{I.value=!0;try{const o=await n.fetchCuppers({page:w.value,limit:P.value,search:N.value});c.value=o.data,M.value=o.pagination.total}catch{l.addNotification({type:"error",message:"Failed to fetch cuppers"})}finally{I.value=!1}},C=async()=>{try{const o=await n.fetchCupperStats();Object.assign(g,o)}catch{l.addNotification({type:"error",message:"Failed to fetch cupper stats"})}},$=o=>{w.value=o,b()},z=()=>{w.value=1,b()},k=async o=>{try{await n.updateCupperPermissions(o.id,{canCreateSession:o.canCreateSession,isAdmin:o.isAdmin,isActive:o.isActive}),l.addNotification({type:"success",message:"Permissions updated successfully"}),C()}catch{l.addNotification({type:"error",message:"Failed to update permissions"})}},B=async o=>{try{l.addNotification({type:"success",message:"Cupper removed successfully"}),b(),C()}catch{l.addNotification({type:"error",message:"Failed to remove cupper"})}},D=()=>{h.value=!0},O=async()=>{if(!u.email){l.addNotification({type:"error",message:"Email is required"});return}U.value=!0;try{await n.inviteCupper(u.email),l.addNotification({type:"success",message:"Invitation sent successfully"}),h.value=!1,u.name="",u.email="",u.role="member",C()}catch{l.addNotification({type:"error",message:"Failed to send invitation"})}finally{U.value=!1}},R=()=>{l.addNotification({type:"info",message:"Upgrade plans feature coming soon"})},q=o=>{if(!o.name)return o.email.charAt(0).toUpperCase();const e=o.name.split(" ");return e.length===1?e[0].charAt(0).toUpperCase():(e[0].charAt(0)+e[e.length-1].charAt(0)).toUpperCase()},j=o=>o?new Date(o).toLocaleString():"Never";return(o,e)=>{const y=d("el-button"),x=d("el-input"),H=d("el-spinner"),f=d("el-table-column"),F=d("el-checkbox"),Q=d("el-dropdown-item"),T=d("el-dropdown-menu"),X=d("el-dropdown"),G=d("el-table"),J=d("el-pagination"),V=d("el-form-item"),E=d("el-option"),K=d("el-select"),W=d("el-form"),Y=d("el-dialog");return S(),A("div",ie,[t("div",le,[e[8]||(e[8]=t("h1",null,"Cuppers",-1)),e[9]||(e[9]=t("h2",null,"Manage cuppers",-1)),t("div",re,[s(y,{type:"primary",onClick:D},{default:i(()=>e[6]||(e[6]=[t("i",{class:"el-icon-plus"},null,-1),_(" Invite member ")])),_:1,__:[6]}),s(y,{plain:"",onClick:R},{default:i(()=>e[7]||(e[7]=[t("i",{class:"el-icon-s-promotion"},null,-1),_(" Upgrade plans ")])),_:1,__:[7]})])]),t("div",de,[t("div",ue,[e[11]||(e[11]=t("div",{class:"icon orange"},[t("i",{class:"el-icon-user-solid"})],-1)),t("div",pe,[t("div",ce,v(g.members),1),e[10]||(e[10]=t("div",{class:"title"},"Members",-1))])]),t("div",me,[e[13]||(e[13]=t("div",{class:"icon orange"},[t("i",{class:"el-icon-star-on"})],-1)),t("div",ve,[t("div",_e,v(g.admins),1),e[12]||(e[12]=t("div",{class:"title"},"Admins",-1))])]),t("div",fe,[e[15]||(e[15]=t("div",{class:"icon orange"},[t("i",{class:"el-icon-user"})],-1)),t("div",ge,[t("div",he,v(g.pendingInvites),1),e[14]||(e[14]=t("div",{class:"title"},"Pending invites",-1))])]),t("div",ye,[e[17]||(e[17]=t("div",{class:"icon orange"},[t("i",{class:"el-icon-user-solid"})],-1)),t("div",we,[t("div",be,v(g.seatsAvailable),1),e[16]||(e[16]=t("div",{class:"title"},"Seats available",-1))])])]),t("div",Ce,[t("div",Ve,[s(x,{placeholder:"Search name or email","prefix-icon":"el-icon-search",modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=a=>N.value=a),onInput:z},null,8,["modelValue"])]),I.value?(S(),A("div",Ae,[s(H),e[18]||(e[18]=t("p",null,"Loading cuppers...",-1))])):c.value.length===0?(S(),A("div",Se,[e[20]||(e[20]=t("img",{src:se,alt:"No Results",class:"icon"},null,-1)),e[21]||(e[21]=t("h2",{class:"title"},"No results found",-1)),e[22]||(e[22]=t("p",{class:"description"},"No cuppers have been added yet. Start by inviting team members.",-1)),s(y,{type:"primary",onClick:D},{default:i(()=>e[19]||(e[19]=[t("i",{class:"el-icon-plus"},null,-1),_(" Invite member ")])),_:1,__:[19]})])):(S(),A("div",Ie,[t("div",Ne,[s(G,{data:c.value,style:{width:"100%"}},{default:i(()=>[s(f,{label:"Name","min-width":"200"},{default:i(a=>[t("div",Ue,[t("div",ke,v(q(a.row)),1),t("div",null,[t("div",xe,v(a.row.name),1),t("div",Fe,v(a.row.email),1)])])]),_:1}),s(f,{label:"Can create cupping session",width:"200"},{default:i(a=>[s(F,{modelValue:a.row.canCreateSession,"onUpdate:modelValue":p=>a.row.canCreateSession=p,onChange:p=>k(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),s(f,{label:"Admin",width:"120"},{default:i(a=>[s(F,{modelValue:a.row.isAdmin,"onUpdate:modelValue":p=>a.row.isAdmin=p,onChange:p=>k(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),s(f,{label:"Active",width:"120"},{default:i(a=>[s(F,{modelValue:a.row.isActive,"onUpdate:modelValue":p=>a.row.isActive=p,onChange:p=>k(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),s(f,{label:"Last activity",width:"200"},{default:i(a=>[_(v(j(a.row.lastActivity)),1)]),_:1}),s(f,{label:"Actions",width:"100"},{default:i(a=>[s(X,null,{dropdown:i(()=>[s(T,null,{default:i(()=>[s(Q,{onClick:p=>B(a.row.id)},{default:i(()=>e[23]||(e[23]=[t("i",{class:"el-icon-delete"},null,-1),_(" Remove ")])),_:2,__:[23]},1032,["onClick"])]),_:2},1024)]),default:i(()=>[e[24]||(e[24]=t("i",{class:"el-icon-more"},null,-1))]),_:2,__:[24]},1024)]),_:1})]),_:1},8,["data"])]),t("div",Pe,[s(J,{layout:"prev, pager, next",total:M.value,"page-size":P.value,"current-page":w.value,onCurrentChange:$},null,8,["total","page-size","current-page"])])]))]),s(Y,{title:"Invite new member",modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=a=>h.value=a),width:"500px"},{default:i(()=>[s(W,{onSubmit:te(O,["prevent"])},{default:i(()=>[s(V,{label:"Name"},{default:i(()=>[s(x,{modelValue:u.name,"onUpdate:modelValue":e[1]||(e[1]=a=>u.name=a),placeholder:"Enter name"},null,8,["modelValue"])]),_:1}),s(V,{label:"Email"},{default:i(()=>[s(x,{modelValue:u.email,"onUpdate:modelValue":e[2]||(e[2]=a=>u.email=a),placeholder:"Enter email",required:""},null,8,["modelValue"])]),_:1}),s(V,{label:"Role"},{default:i(()=>[s(K,{modelValue:u.role,"onUpdate:modelValue":e[3]||(e[3]=a=>u.role=a),placeholder:"Select role"},{default:i(()=>[s(E,{label:"Member",value:"member"}),s(E,{label:"Admin",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),s(V,null,{default:i(()=>[s(y,{type:"primary","native-type":"submit",loading:U.value},{default:i(()=>e[25]||(e[25]=[_(" Send Invite ")])),_:1,__:[25]},8,["loading"]),s(y,{onClick:e[4]||(e[4]=a=>h.value=!1)},{default:i(()=>e[26]||(e[26]=[_("Cancel")])),_:1,__:[26]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},$e=ae(Me,[["__scopeId","data-v-f8345188"]]);export{$e as default};
